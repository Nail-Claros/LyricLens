{% extends '_template.html' %}
{% block styles %}
    <link rel="stylesheet" href="static/styles/translation.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
{% endblock %}
{% block body %}
<body>
    <nav class="navbar-img">
        <img src="{{ url_for('static', filename='images/Lyric Lens (Text Logo and Icon) - Horizontal.png')}}" style="height: 100px; width: 300px; padding-bottom: 80px;">
    </nav>
    <nav class="navbar">
        <ul class="nav-links">
            <li><a href="{{url_for('index')}}">HOME</a></li>
            <li><a href="{{url_for('about')}}">ABOUT</a></li>
            <li><a href="{{url_for('history')}}">HISTORY</a></li>
        </ul>
    </nav>


    <div class="container">
        <!-- Album Cover and Song Information -->
        <div class="album-info" style="justify-content: center;">
            <img src="{{ ca }}" alt="Album Cover" class="album-cover">
            <div class="song-details">
                <h2 class="song-name">{{ name }}</h2>
                <p class="song-artist">{{ art }}</p>
            </div>
        </div>
        
        <!-- Translation Section -->
        <div class="translation-section">
            <!-- Original Language -->
            <div class="original-lang">
                <h4>Original Language:</h4>
                <h5>{{lang | capitalize }}</h5>
                <textarea readonly class="text" placeholder="{{ lyric }}">{{ lyric }}</textarea>
            </div>
            
            
            <!-- Translation Language -->
            <div class="translated-lang">
                <h3>Translated:</h3>
                <select id="myDropdown" style="justify-content: center; align-items: center; text-align: center;">
                    <option value="">Select a language</option>
                    {% for key, value in ldict.items() %}
                        {% if value|upper != lang|upper %}
                            <option value="{{ key }}">{{ value }}</option>
                        {% endif %}
                    {% endfor %}
                </select>
                <textarea id="translation" class="textbox, text" placeholder="Pick a language! Translations will appear here!" readonly>Translated</textarea>
            </div>
        </div>

    </div>
    
    <script>
        $(document).ready(function() {
            $('#myDropdown').change(function() {
                updateTranslation($(this).val());
            });
        });

        function updateTranslation(selectedLang) {
            const textToTranslate = `{{ lyric }}`;

            if (selectedLang) {
                $.ajax({
                    url: '/translate',
                    type: 'POST',
                    contentType: 'application/json',
                    data: JSON.stringify({ text: textToTranslate, lang: selectedLang }),
                    success: function(response) {
                        $('#translation').val(response.translatedText);
                    },
                    error: function() {
                        alert('Error translating text');
                    }
                });
            } else {
                $('#translation').val('');
            }
        }
    </script>
    
</body>
{% endblock %}
